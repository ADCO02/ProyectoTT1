\doxysection{elements.\+cpp}
\hypertarget{elements_8cpp_source}{}\label{elements_8cpp_source}\index{src/elements.cpp@{src/elements.cpp}}

\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{elements_8cpp_source_l00001}00001\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{elements_8hpp}{..\(\backslash\)include\(\backslash\)elements.hpp}}"{}}}
\DoxyCodeLine{\Hypertarget{elements_8cpp_source_l00002}00002\ }
\DoxyCodeLine{\Hypertarget{elements_8cpp_source_l00003}\mbox{\hyperlink{elements_8hpp_a5dd6d5680c9b5aafae7e21082e0ab75a}{00003}}\ tuple<double,\ double,\ double,\ double,\ double,\ double,\ double>\ \mbox{\hyperlink{elements_8hpp_a5dd6d5680c9b5aafae7e21082e0ab75a}{elements}}(\mbox{\hyperlink{class_matrix}{Matrix}}\&\ y)\{\ }
\DoxyCodeLine{\Hypertarget{elements_8cpp_source_l00004}00004\ \ \ \ \ \mbox{\hyperlink{class_matrix}{Matrix}}\&\ r\ =\ y.\mbox{\hyperlink{class_matrix_ac6b4e87c2c5a6d53121eafcfbc483917}{extract\_vector}}(1,3);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Position}}
\DoxyCodeLine{\Hypertarget{elements_8cpp_source_l00005}00005\ \ \ \ \ \mbox{\hyperlink{class_matrix}{Matrix}}\&\ v\ =\ y.\mbox{\hyperlink{class_matrix_ac6b4e87c2c5a6d53121eafcfbc483917}{extract\_vector}}(4,6);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Velocity}}
\DoxyCodeLine{\Hypertarget{elements_8cpp_source_l00006}00006\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{elements_8cpp_source_l00007}00007\ \ \ \ \ \mbox{\hyperlink{class_matrix}{Matrix}}\&\ h\ =\ \mbox{\hyperlink{matrix_8hpp_a08b20c4fe4332345ef52eaa22cbf181a}{cross}}(r,v);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Areal\ velocity}}
\DoxyCodeLine{\Hypertarget{elements_8cpp_source_l00008}00008\ \ \ \ \ \textcolor{keywordtype}{double}\ magh\ =\ \mbox{\hyperlink{matrix_8hpp_a4171206f7b54c775745f80c5fb77b2c0}{norm}}(h);}
\DoxyCodeLine{\Hypertarget{elements_8cpp_source_l00009}00009\ \ \ \ \ \textcolor{keywordtype}{double}\ p\ =\ magh*magh/GM\_Earth;}
\DoxyCodeLine{\Hypertarget{elements_8cpp_source_l00010}00010\ \ \ \ \ \textcolor{keywordtype}{double}\ H\ =\ \mbox{\hyperlink{matrix_8hpp_a4171206f7b54c775745f80c5fb77b2c0}{norm}}(h);}
\DoxyCodeLine{\Hypertarget{elements_8cpp_source_l00011}00011\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{elements_8cpp_source_l00012}00012\ \ \ \ \ \textcolor{keywordtype}{double}\ Omega\ =\ atan2\ (\ h(1),\ -\/h(2)\ );\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Long.\ ascend.\ node\ }}
\DoxyCodeLine{\Hypertarget{elements_8cpp_source_l00013}00013\ \ \ \ \ Omega\ =\ fmod(Omega,pi2);}
\DoxyCodeLine{\Hypertarget{elements_8cpp_source_l00014}00014\ \ \ \ \ \textcolor{keywordflow}{if}(Omega<0)\{}
\DoxyCodeLine{\Hypertarget{elements_8cpp_source_l00015}00015\ \ \ \ \ \ \ \ \ Omega+=pi2;}
\DoxyCodeLine{\Hypertarget{elements_8cpp_source_l00016}00016\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{elements_8cpp_source_l00017}00017\ \ \ \ \ \textcolor{keywordtype}{double}\ i\ \ \ \ \ =\ atan2\ (\ sqrt(h(1)*h(1)+h(2)*h(2)),\ h(3)\ );\ \textcolor{comment}{//\ Inclination\ \ \ \ \ \ \ \ }}
\DoxyCodeLine{\Hypertarget{elements_8cpp_source_l00018}00018\ \ \ \ \ \textcolor{keywordtype}{double}\ u\ \ \ \ \ =\ atan2\ (\ r(3)*H,\ -\/r(1)*h(2)+r(2)*h(1)\ );\ \ \ \ \textcolor{comment}{//\ Arg.\ of\ latitude}}
\DoxyCodeLine{\Hypertarget{elements_8cpp_source_l00019}00019\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{elements_8cpp_source_l00020}00020\ \ \ \ \ \textcolor{keywordtype}{double}\ R\ \ =\ \mbox{\hyperlink{matrix_8hpp_a4171206f7b54c775745f80c5fb77b2c0}{norm}}(r);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Distance}}
\DoxyCodeLine{\Hypertarget{elements_8cpp_source_l00021}00021\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{elements_8cpp_source_l00022}00022\ \ \ \ \ \textcolor{keywordtype}{double}\ a\ =\ 1/(2/R\ -\/\ \mbox{\hyperlink{matrix_8hpp_a8d69098a17359927ba56f235d1012f8d}{dot}}(v,v)/GM\_Earth);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Semi-\/major\ axis\ \ \ \ }}
\DoxyCodeLine{\Hypertarget{elements_8cpp_source_l00023}00023\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{elements_8cpp_source_l00024}00024\ \ \ \ \ \textcolor{keywordtype}{double}\ eCosE\ =\ 1-\/R/a;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ e*cos(E)\ \ \ \ \ \ \ \ \ \ \ }}
\DoxyCodeLine{\Hypertarget{elements_8cpp_source_l00025}00025\ \ \ \ \ \textcolor{keywordtype}{double}\ eSinE\ =\ \mbox{\hyperlink{matrix_8hpp_a8d69098a17359927ba56f235d1012f8d}{dot}}(r,v)/sqrt(GM\_Earth*a);\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ e*sin(E)\ \ \ \ \ \ \ \ \ \ \ }}
\DoxyCodeLine{\Hypertarget{elements_8cpp_source_l00026}00026\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{elements_8cpp_source_l00027}00027\ \ \ \ \ \textcolor{keywordtype}{double}\ e2\ =\ eCosE*eCosE\ +eSinE*eSinE;}
\DoxyCodeLine{\Hypertarget{elements_8cpp_source_l00028}00028\ \ \ \ \ \textcolor{keywordtype}{double}\ e\ \ =\ sqrt(e2);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Eccentricity\ }}
\DoxyCodeLine{\Hypertarget{elements_8cpp_source_l00029}00029\ \ \ \ \ \textcolor{keywordtype}{double}\ E\ \ =\ atan2(eSinE,eCosE);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Eccentric\ anomaly\ \ }}
\DoxyCodeLine{\Hypertarget{elements_8cpp_source_l00030}00030\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{elements_8cpp_source_l00031}00031\ \ \ \ \ \textcolor{keywordtype}{double}\ M\ \ =\ fmod(E-\/eSinE,pi2);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Mean\ anomaly}}
\DoxyCodeLine{\Hypertarget{elements_8cpp_source_l00032}00032\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{elements_8cpp_source_l00033}00033\ \ \ \ \ \textcolor{keywordtype}{double}\ nu\ =\ atan2(sqrt(1.0-\/e2)*eSinE,\ eCosE-\/e2);\ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ True\ anomaly}}
\DoxyCodeLine{\Hypertarget{elements_8cpp_source_l00034}00034\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{elements_8cpp_source_l00035}00035\ \ \ \ \ \textcolor{keywordtype}{double}\ omega\ =\ fmod(u-\/nu,pi2);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Arg.\ of\ perihelion\ }}
\DoxyCodeLine{\Hypertarget{elements_8cpp_source_l00036}00036\ \ \ \ \ \textcolor{keywordflow}{if}(omega<0)\{}
\DoxyCodeLine{\Hypertarget{elements_8cpp_source_l00037}00037\ \ \ \ \ \ \ \ \ omega+=pi2;}
\DoxyCodeLine{\Hypertarget{elements_8cpp_source_l00038}00038\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{elements_8cpp_source_l00039}00039\ }
\DoxyCodeLine{\Hypertarget{elements_8cpp_source_l00040}00040\ \ \ \ \ \textcolor{keywordflow}{return}\ tie(p,\ a,\ e,\ i,\ Omega,\ omega,\ M);}
\DoxyCodeLine{\Hypertarget{elements_8cpp_source_l00041}00041\ \}}

\end{DoxyCode}
